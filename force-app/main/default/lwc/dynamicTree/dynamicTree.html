<template>
    <div class="slds-form-element slds-m-bottom_small">
        <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left">
            <lightning-icon icon-name="utility:search" size="x-small" alternative-text="Search" class="slds-input__icon slds-input__icon_left"></lightning-icon>
            <input type="text" id="slds-input" placeholder="Search for data type" class="slds-input" onchange={handleSearch} />
        </div>
    </div>
    <template if:true={treeData}>
        <div class="slds-tree-container">
            <h4 class="slds-tree__group-header slds-m-bottom_xxx-small" id="treeheading">Intestate details</h4>
            <ul class="slds-tree" role="tree">
                <template for:each={filteredTreeData} for:item="node">
                    <li key={node.label} role="treeitem" aria-level="1">
                        <div class="slds-tree__item">
                            <template if:true={node.children}>
                                <button class="slds-button slds-button_icon slds-m-right_x-small" aria-hidden="true" tabindex="-1" onclick={handleToggle} data-label={node.label}>
                                    <lightning-icon icon-name={node.icon} alternative-text="Expand" size="x-small"></lightning-icon>
                                </button>
                            </template>
                            <span class="slds-has-flexi-truncate">
                                <span class="slds-tree__item-label slds-truncate" title={node.label} data-label={node.label} data-object={node.object} onclick={handleNavigation} data-parent-label={node.label}>
                                    {node.label}
                                </span>
                            </span>
                        </div>
                        <template if:true={node.children}>
                            <ul class="slds-is-collapsed">
                                <template for:each={node.children} for:item="child">
                                    <li key={child.label} aria-level="3">
                                        <div class="slds-tree__item">
                                            <template if:true={child.children}>
                                                <button class="slds-button slds-button_icon slds-m-right_x-small" aria-hidden="true" tabindex="-1" onclick={handleToggle} data-label={child.label}>
                                                    <lightning-icon icon-name={child.icon} alternative-text="Expand" size="x-small"></lightning-icon>
                                                </button>
                                            </template>
                                            <span class="slds-has-flexi-truncate">
                                                <span class="slds-tree__item-label slds-truncate" title={child.label} data-label={child.label} data-object={child.object} onclick={handleNavigation} data-parent-label={node.label}>
                                                    {child.label}
                                                </span>
                                            </span>
                                        </div>
                                        <template if:true={child.children}>
                                            <ul class="slds-is-collapsed">
                                                <template for:each={child.children} for:item="grandchild">
                                                    <li key={grandchild.label} aria-level="4">
                                                        <div class="slds-tree__item">
                                                            <template if:true={grandchild.children}>
                                                                <button class="slds-button slds-button_icon slds-m-right_x-small" aria-hidden="true" tabindex="-1" onclick={handleToggle} data-label={grandchild.label}>
                                                                    <lightning-icon icon-name={grandchild.icon} alternative-text="Expand" size="x-small"></lightning-icon>
                                                                </button>
                                                            </template>
                                                            <span class="slds-has-flexi-truncate">
                                                                <span class="slds-tree__item-label slds-truncate" title={grandchild.label} data-label={grandchild.label} data-object={grandchild.object} onclick={handleNavigation} data-parent-label={child.label}>
                                                                    {grandchild.label}
                                                                </span>
                                                            </span>
                                                        </div>
                                                    </li>
                                                </template>
                                            </ul>
                                        </template>
                                    </li>
                                </template>
                            </ul>
                        </template>
                    </li>
                </template>
            </ul>
        </div>
    </template>
    <template if:true={error}>
        <div class="slds-text-color_error">{error}</div>
    </template>
</template>